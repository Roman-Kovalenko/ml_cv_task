
# **Обработка видео с детекцией и трекингом объектов**

Этот проект выполняет **детекцию и трекинг объектов** на видео с помощью **YOLO** и **SORT**.  


---

## **Конфигурация**
Все настройки хранятся в файле **`config.py`**:

| Переменная             | Описание |
|------------------------|----------|
| `MODEL_PATH`          | Путь до модели YOLO |
| `VIDEO_PATH`          | Путь до видеофайла |
| `NUMBER_OBJECTS`      | Максимальное количество объектов в кадре |
| `CONFIDENCE_THRESHOLD` | Порог чувствительности детектора |
| `TARGET_CLASSES`      | Список `class_id` (COCO), которые нужно детектировать |
| `MOTION_THRESHOLD`    | Порог, по которому определяется движение объекта |
| `WITH_ROI`            | Запуск с выделением области интереса (ROI) |

### **Настройки алгоритма SORT**
| Переменная       | Описание |
|------------------|----------|
| `MAX_AGE`       | Количество кадров, которые можно пропустить, прежде чем трек будет удалён |
| `MIN_HINTS`     | Минимальное число детекций, после которых объект начинает отслеживаться |
| `IOU_THRESHOLD` | Порог пересечения (IoU) для сопоставления детекций с существующими треками |

---

## **Запуск**
**Требования:**  
- Python **3.10.0** или выше  
- Установленные зависимости из `requirements.txt`
- GPU 

### **Шаги для запуска**
1. **Создайте и активируйте виртуальное окружение**:
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для macOS/Linux
    venv\Scripts\activate  # Для Windows
    ```
2. **Установите зависимости**:
    ```bash
    pip install -r requirements.txt
    ```
3. **Запустите обработку видео**:
    ```bash
    python main.py
    ```

### **Особенности работы**
- Если **`WITH_ROI = True`**, перед началом обработки на **первом кадре** необходимо выделить **область интереса** и нажать:  
  - `SPACE` / `ENTER` – для подтверждения  
  - `C` – для выхода  
- После завершения детекции **в консоли отобразится статистика** по обработке кадров.  
- **Будет сохранён лучший кадр**, где у объектов **наибольший confidence score**.

---

## **Создание снимка кадра по тайм-коду**
Вы можете получить **снапшот кадра** из видео, передав нужное время в миллисекундах:

```bash
python utils.py <timestamp_ms>
```

- Делает снимок (JPEG) кадра, соответствующего указанному времени.  
- Выводит **количество кадров**, которые пришлось пропустить, чтобы добраться до нужного момента.  
---
